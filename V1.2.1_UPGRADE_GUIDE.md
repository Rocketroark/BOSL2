# v1.2.1 Upgrade Guide - CRITICAL FIXES

## What Was Fixed

### 1. **Rendering Error** ‚úÖ FIXED
- **Problem**: Hex pattern floor caused rendering errors even on default settings
- **Cause**: Incorrect use of `children()` operator in hex_pattern_floor module
- **Fix**: Completely rewrote hex floor generation to properly create honeycomb pattern
- **Result**: System now renders without errors

### 2. **Limited Container Slots** ‚úÖ FIXED
- **Problem**: Only 4 container slots, not enough for multiple bins
- **Fix**: Expanded to **8 container slots**
- **Result**: You can now create 8 different containers (8 bins, 8 token trays, or any mix)

### 3. **Limited Customization** ‚úÖ FIXED
- **Problem**: Lids only worked on token trays; finger grips/stackable were global settings
- **Fix**: Added **per-container customization** for ALL features
- **Result**: Each container has independent control over:
  - `c#_lid` - Lid for this specific container
  - `c#_hex_floor` - Hex floor pattern for this container
  - `c#_hex_walls` - Hex wall pattern for this container
  - `c#_finger_grips` - Finger grips for this container
  - `c#_stackable` - Stackable features for this container

## How to Use the New Features

### Creating Multiple Bins

**Example: 3 different component bins with different settings**

```scad
layout_mode = "multi";

// Bin 1: Coin slots WITH lid and hex floor
c1_enable = true;
c1_type = "component_bin";
c1_bin_type = "coin_slot";
c1_width = 90;
c1_depth = 70;
c1_height = 35;
c1_pos_x = 1;
c1_pos_y = 1;
c1_comp_x = 6;  // 6 coin slots
c1_lid = true;  // THIS bin gets a lid
c1_hex_floor = true;  // THIS bin has hex floor
c1_finger_grips = false;
c1_stackable = false;

// Bin 2: Token wells WITHOUT lid, hex floor + finger grips
c2_enable = true;
c2_type = "component_bin";
c2_bin_type = "token_well";
c2_width = 90;
c2_depth = 90;
c2_height = 30;
c2_pos_x = 95;
c2_pos_y = 1;
c2_comp_x = 9;  // 9 token wells
c2_lid = false;  // No lid
c2_hex_floor = true;  // Has hex floor
c2_finger_grips = true;  // Easy to remove
c2_stackable = false;

// Bin 3: Small parts grid WITH lid and stackable
c3_enable = true;
c3_type = "component_bin";
c3_bin_type = "small_parts";
c3_width = 90;
c3_depth = 90;
c3_height = 25;
c3_pos_x = 190;
c3_pos_y = 1;
c3_lid = true;  // THIS bin gets a lid
c3_hex_floor = true;
c3_finger_grips = false;
c3_stackable = true;  // Can stack multiple
```

### Per-Container Customization Examples

**Card Holder with Lid and Finger Grips:**
```scad
c4_enable = true;
c4_type = "card_holder";
c4_width = 70;
c4_depth = 95;
c4_height = 65;
c4_pos_x = 1;
c4_pos_y = 75;
c4_cutout = 30;  // Finger access to cards
c4_lid = true;  // Lid to protect cards
c4_hex_floor = false;  // Solid floor for cards
c4_finger_grips = true;  // Easy to remove from box
c4_stackable = false;
```

**Dice Tray with Lid:**
```scad
c5_enable = true;
c5_type = "dice_tray";
c5_width = 70;
c5_depth = 70;
c5_height = 25;
c5_pos_x = 95;
c5_pos_y = 130;
c5_lid = true;  // Keep dice from spilling!
c5_hex_floor = false;  // Solid for dice rolling
c5_finger_grips = false;
c5_stackable = false;
```

**Token Tray - Stackable with Hex Floor:**
```scad
c6_enable = true;
c6_type = "token_tray";
c6_width = 65;
c6_depth = 65;
c6_height = 30;
c6_pos_x = 170;
c6_pos_y = 130;
c6_comp_x = 3;
c6_comp_y = 3;
c6_lid = false;
c6_hex_floor = true;  // Save filament
c6_finger_grips = false;
c6_stackable = true;  // Stack multiple trays!
```

## Quick Comparison: Old vs New

### OLD (v1.2)
‚ùå Only 4 container slots
‚ùå Lids only on token trays
‚ùå Rendering error with hex patterns
‚ùå Finger grips/stackable were global (all or nothing)
‚ùå Hex patterns were global

### NEW (v1.2.1)
‚úÖ **8 container slots**
‚úÖ **Lids on ALL container types**
‚úÖ **Rendering error FIXED**
‚úÖ **Per-container finger grips**
‚úÖ **Per-container stackable**
‚úÖ **Per-container hex patterns**

## Migration Guide

If you have existing designs in v1.2, here's how to migrate:

1. **Open your v1.2 file**
2. **Note your settings** for each container
3. **Open v1.2.1** (parametric_game_insert.scad)
4. **Set layout_mode = "multi"**
5. **For each container**, enable a slot and configure:
   - All the basic settings (type, width, depth, height, position)
   - **NEW**: Set `c#_lid = true` for containers that need lids
   - **NEW**: Set `c#_hex_floor = true` for filament savings
   - **NEW**: Set `c#_finger_grips = true` for easy removal
   - **NEW**: Set `c#_stackable = true` if you want to stack

## All Per-Container Parameters

Each of the 8 slots (c1 through c8) has these parameters:

### Basic
- `c#_enable` - Turn this slot on/off
- `c#_type` - card_holder, component_bin, dice_tray, token_tray
- `c#_width`, `c#_depth`, `c#_height` - Dimensions
- `c#_pos_x`, `c#_pos_y` - Position from bottom-left

### Type-Specific
- `c#_bin_type` - For component_bin: general, coin_slot, token_well, small_parts, card_divider
- `c#_comp_x` - Number of compartments/slots (X direction)
- `c#_comp_y` - Number of compartments (Y direction, for token trays)
- `c#_divider` - Add divider (for general bins)
- `c#_cutout` - Finger cutout (for card holders)

### **NEW** Per-Container Features
- `c#_lid` - **Generate lid for THIS container** (works on ALL types!)
- `c#_hex_floor` - **Hex floor pattern for THIS container** (save filament!)
- `c#_hex_walls` - **Hex wall pattern for THIS container** (save more!)
- `c#_finger_grips` - **Finger grips for THIS container** (easy removal!)
- `c#_stackable` - **Stackable features for THIS container** (stack multiples!)

## Examples of What's Now Possible

### Example 1: Game with Multiple Token Types
```
Slot 1: Large tokens (3x3 grid, no lid, hex floor)
Slot 2: Medium tokens (4x4 grid, WITH lid, hex floor)
Slot 3: Small tokens (5x5 grid, WITH lid, hex floor, stackable)
Slot 4: Coins (coin slot bin, WITH lid, hex floor)
Slot 5: Card holder (no lid, finger grips, solid floor)
Slot 6: Dice tray (WITH lid)
Slot 7: Small parts (WITH lid, stackable)
Slot 8: Extra token tray (2x2 grid, hex floor)
```

### Example 2: Miniature Game
```
Slot 1-3: Three different sized token trays (all with hex floors)
Slot 4: Coin bin with lid
Slot 5: Card holder with finger grips
Slot 6: Dice tray with lid
Slot 7-8: Two component bins (different types, both with lids)
```

## Testing Your Design

1. **Enable one container at a time** to verify it renders correctly
2. **Check validation output** in the console
3. **Use preview mode** (F5) to see layout quickly
4. **Enable lids** to see them in exploded view
5. **Render** (F6) when ready to export

## Need More Than 8 Slots?

The system can easily be expanded. If you need more than 8 slots, let me know and I can add slots 9-12 or more!

## Summary

**v1.2.1 gives you:**
- ‚úÖ Fixed rendering
- ‚úÖ 8 containers (not 4)
- ‚úÖ Lids on EVERYTHING
- ‚úÖ Individual customization per container
- ‚úÖ Complete control over your game insert

**You can now create complex game inserts with:**
- Multiple bins of the same type but different configurations
- Lids on only the containers that need them
- Hex patterns only where you want filament savings
- Finger grips only on hard-to-remove containers
- Stackable features only on containers you want to stack

Enjoy your fully customized game inserts! üé≤üéÆ
